{% extends "base.html" %}

{% block title %}–í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã - Receipt Scanner{% endblock %}

{% block content %}
<div class="card">
    <h2>üìÑ –í—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã ({{ documents|length }})</h2>
    
    {% if documents %}
        {% for doc in documents %}
        <div class="document-item">
            <div class="document-title">
                {% if doc.document_type == 'email_content' %}
                    üìß {{ doc.subject[:60] }}{% if doc.subject|length > 60 %}...{% endif %}
                {% else %}
                    üìÅ {{ doc.filename }}
                {% endif %}
            </div>
            <div class="document-meta">
                üìß <strong>–û—Ç:</strong> {{ doc.sender }}<br>
                üìÖ <strong>–î–∞—Ç–∞ –ø–∏—Å—å–º–∞:</strong> {{ doc.email_date }}<br>
                üè∑Ô∏è <strong>–¢–µ–º–∞:</strong> {{ doc.subject }}<br>
                üìë <strong>–¢–∏–ø:</strong> {{ '–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∏—Å—å–º–∞' if doc.document_type == 'email_content' else '–í–ª–æ–∂–µ–Ω–∏–µ' }}<br>
                üåê <strong>–Ø–∑—ã–∫:</strong> {{ doc.language }}<br>
                üî¢ <strong>–û—Ü–µ–Ω–∫–∞:</strong> {{ doc.financial_score }}/100<br>
                üìä <strong>–¢–∏–ø —Ñ–∞–π–ª–∞:</strong> {{ doc.mime_type }}<br>
                ‚è∞ <strong>–û–±—Ä–∞–±–æ—Ç–∞–Ω:</strong> {{ doc.processed_date }}<br>
                {% if doc.gmail_url %}
                    üîó <strong>Gmail:</strong> <a href="{{ doc.gmail_url }}" target="_blank" style="color: #3498db;">–û—Ç–∫—Ä—ã—Ç—å –ø–∏—Å—å–º–æ</a>
                {% endif %}
            </div>
            
            {% if doc.amounts_found %}
            <div class="document-amounts">
                üí∞ <strong>–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å—É–º–º—ã:</strong> {{ doc.amounts_found|join(', ') }}
            </div>
            {% endif %}
            
            {% if doc.keywords_found %}
            <div class="document-keywords">
                üî§ <strong>–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:</strong> {{ doc.keywords_found|join(', ') }}
            </div>
            {% endif %}
            
            {% if doc.text_content %}
            <details style="margin-top: 0.5rem;">
                <summary style="cursor: pointer; color: #3498db;">üìù –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞</summary>
                <div style="background: #f8f9fa; padding: 1rem; border-radius: 5px; margin-top: 0.5rem; font-family: monospace; font-size: 0.9rem; max-height: 200px; overflow-y: auto;">
                    {{ doc.text_content }}
                </div>
            </details>
            {% endif %}
        </div>
        {% endfor %}
    {% else %}
        <div style="text-align: center; padding: 2rem;">
            <p>üì≠ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
            <p>–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Gmail:</p>
            <pre><code>cd src && python main.py scan</code></pre>
        </div>
    {% endif %}
</div>

{% if documents|length >= 50 %}
<div class="card">
    <p><strong>–ü–æ–∫–∞–∑–∞–Ω—ã –ø–µ—Ä–≤—ã–µ 50 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.</strong> –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∏—Å–∫ –∏–ª–∏ –∫–æ–º–∞–Ω–¥—É:</p>
    <pre><code>python main.py show 100</code></pre>
</div>
{% endif %}
{% endblock %}